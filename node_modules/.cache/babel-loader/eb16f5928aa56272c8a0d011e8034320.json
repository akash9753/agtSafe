{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n          case 7:\n            op = _.ops.pop();\n            _.trys.pop();\n            continue;\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n              _.ops.push(op);\n              break;\n            }\n            if (t[2]) _.ops.pop();\n            _.trys.pop();\n            continue;\n        }\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n  return r;\n};\nimport { ComposedTreeDelegate } from './abstractTree.js';\nimport { ObjectTree, CompressibleObjectTree } from './objectTree.js';\nimport { TreeError, WeakMapper } from './tree.js';\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { timeout, createCancelablePromise } from '../../../common/async.js';\nimport { Iterator } from '../../../common/iterator.js';\nimport { ElementsDragAndDropData } from '../list/listView.js';\nimport { isPromiseCanceledError, onUnexpectedError } from '../../../common/errors.js';\nimport { toggleClass } from '../../dom.js';\nimport { values } from '../../../common/map.js';\nimport { isFilterResult, getVisibleState } from './indexTreeModel.js';\nfunction createAsyncDataTreeNode(props) {\n  return __assign(__assign({}, props), {\n    children: [],\n    refreshPromise: undefined,\n    stale: true,\n    slow: false,\n    collapsedByDefault: undefined\n  });\n}\nfunction isAncestor(ancestor, descendant) {\n  if (!descendant.parent) {\n    return false;\n  } else if (descendant.parent === ancestor) {\n    return true;\n  } else {\n    return isAncestor(ancestor, descendant.parent);\n  }\n}\nfunction intersects(node, other) {\n  return node === other || isAncestor(node, other) || isAncestor(other, node);\n}\nvar AsyncDataTreeNodeWrapper = /** @class */function () {\n  function AsyncDataTreeNodeWrapper(node) {\n    this.node = node;\n  }\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"element\", {\n    get: function get() {\n      return this.node.element.element;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"children\", {\n    get: function get() {\n      return this.node.children.map(function (node) {\n        return new AsyncDataTreeNodeWrapper(node);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"depth\", {\n    get: function get() {\n      return this.node.depth;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visibleChildrenCount\", {\n    get: function get() {\n      return this.node.visibleChildrenCount;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visibleChildIndex\", {\n    get: function get() {\n      return this.node.visibleChildIndex;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"collapsible\", {\n    get: function get() {\n      return this.node.collapsible;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"collapsed\", {\n    get: function get() {\n      return this.node.collapsed;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visible\", {\n    get: function get() {\n      return this.node.visible;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"filterData\", {\n    get: function get() {\n      return this.node.filterData;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return AsyncDataTreeNodeWrapper;\n}();\nvar AsyncDataTreeRenderer = /** @class */function () {\n  function AsyncDataTreeRenderer(renderer, nodeMapper, onDidChangeTwistieState) {\n    this.renderer = renderer;\n    this.nodeMapper = nodeMapper;\n    this.onDidChangeTwistieState = onDidChangeTwistieState;\n    this.renderedNodes = new Map();\n    this.templateId = renderer.templateId;\n  }\n  AsyncDataTreeRenderer.prototype.renderTemplate = function (container) {\n    var templateData = this.renderer.renderTemplate(container);\n    return {\n      templateData: templateData\n    };\n  };\n  AsyncDataTreeRenderer.prototype.renderElement = function (node, index, templateData, height) {\n    this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n  };\n  AsyncDataTreeRenderer.prototype.renderTwistie = function (element, twistieElement) {\n    toggleClass(twistieElement, 'codicon-loading', element.slow);\n    return false;\n  };\n  AsyncDataTreeRenderer.prototype.disposeElement = function (node, index, templateData, height) {\n    if (this.renderer.disposeElement) {\n      this.renderer.disposeElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n  };\n  AsyncDataTreeRenderer.prototype.disposeTemplate = function (templateData) {\n    this.renderer.disposeTemplate(templateData.templateData);\n  };\n  AsyncDataTreeRenderer.prototype.dispose = function () {\n    this.renderedNodes.clear();\n  };\n  return AsyncDataTreeRenderer;\n}();\nfunction asTreeEvent(e) {\n  return {\n    browserEvent: e.browserEvent,\n    elements: e.elements.map(function (e) {\n      return e.element;\n    })\n  };\n}\nvar AsyncDataTreeElementsDragAndDropData = /** @class */function (_super) {\n  __extends(AsyncDataTreeElementsDragAndDropData, _super);\n  function AsyncDataTreeElementsDragAndDropData(data) {\n    var _this = _super.call(this, data.elements.map(function (node) {\n      return node.element;\n    })) || this;\n    _this.data = data;\n    return _this;\n  }\n  return AsyncDataTreeElementsDragAndDropData;\n}(ElementsDragAndDropData);\nfunction asAsyncDataTreeDragAndDropData(data) {\n  if (data instanceof ElementsDragAndDropData) {\n    return new AsyncDataTreeElementsDragAndDropData(data);\n  }\n  return data;\n}\nvar AsyncDataTreeNodeListDragAndDrop = /** @class */function () {\n  function AsyncDataTreeNodeListDragAndDrop(dnd) {\n    this.dnd = dnd;\n  }\n  AsyncDataTreeNodeListDragAndDrop.prototype.getDragURI = function (node) {\n    return this.dnd.getDragURI(node.element);\n  };\n  AsyncDataTreeNodeListDragAndDrop.prototype.getDragLabel = function (nodes, originalEvent) {\n    if (this.dnd.getDragLabel) {\n      return this.dnd.getDragLabel(nodes.map(function (node) {\n        return node.element;\n      }), originalEvent);\n    }\n    return undefined;\n  };\n  AsyncDataTreeNodeListDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\n    if (this.dnd.onDragStart) {\n      this.dnd.onDragStart(asAsyncDataTreeDragAndDropData(data), originalEvent);\n    }\n  };\n  AsyncDataTreeNodeListDragAndDrop.prototype.onDragOver = function (data, targetNode, targetIndex, originalEvent, raw) {\n    if (raw === void 0) {\n      raw = true;\n    }\n    return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\n  };\n  AsyncDataTreeNodeListDragAndDrop.prototype.drop = function (data, targetNode, targetIndex, originalEvent) {\n    this.dnd.drop(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\n  };\n  AsyncDataTreeNodeListDragAndDrop.prototype.onDragEnd = function (originalEvent) {\n    if (this.dnd.onDragEnd) {\n      this.dnd.onDragEnd(originalEvent);\n    }\n  };\n  return AsyncDataTreeNodeListDragAndDrop;\n}();\nfunction asObjectTreeOptions(options) {\n  return options && __assign(__assign({}, options), {\n    collapseByDefault: true,\n    identityProvider: options.identityProvider && {\n      getId: function getId(el) {\n        return options.identityProvider.getId(el.element);\n      }\n    },\n    dnd: options.dnd && new AsyncDataTreeNodeListDragAndDrop(options.dnd),\n    multipleSelectionController: options.multipleSelectionController && {\n      isSelectionSingleChangeEvent: function isSelectionSingleChangeEvent(e) {\n        return options.multipleSelectionController.isSelectionSingleChangeEvent(__assign(__assign({}, e), {\n          element: e.element\n        }));\n      },\n      isSelectionRangeChangeEvent: function isSelectionRangeChangeEvent(e) {\n        return options.multipleSelectionController.isSelectionRangeChangeEvent(__assign(__assign({}, e), {\n          element: e.element\n        }));\n      }\n    },\n    accessibilityProvider: options.accessibilityProvider && __assign(__assign({}, options.accessibilityProvider), {\n      getAriaLabel: function getAriaLabel(e) {\n        return options.accessibilityProvider.getAriaLabel(e.element);\n      },\n      getAriaLevel: options.accessibilityProvider.getAriaLevel && function (node) {\n        return options.accessibilityProvider.getAriaLevel(node.element);\n      },\n      getActiveDescendantId: options.accessibilityProvider.getActiveDescendantId && function (node) {\n        return options.accessibilityProvider.getActiveDescendantId(node.element);\n      }\n    }),\n    filter: options.filter && {\n      filter: function filter(e, parentVisibility) {\n        return options.filter.filter(e.element, parentVisibility);\n      }\n    },\n    keyboardNavigationLabelProvider: options.keyboardNavigationLabelProvider && __assign(__assign({}, options.keyboardNavigationLabelProvider), {\n      getKeyboardNavigationLabel: function getKeyboardNavigationLabel(e) {\n        return options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element);\n      }\n    }),\n    sorter: undefined,\n    expandOnlyOnTwistieClick: typeof options.expandOnlyOnTwistieClick === 'undefined' ? undefined : typeof options.expandOnlyOnTwistieClick !== 'function' ? options.expandOnlyOnTwistieClick : function (e) {\n      return options.expandOnlyOnTwistieClick(e.element);\n    },\n    ariaProvider: options.ariaProvider && {\n      getPosInSet: function getPosInSet(el, index) {\n        return options.ariaProvider.getPosInSet(el.element, index);\n      },\n      getSetSize: function getSetSize(el, index, listLength) {\n        return options.ariaProvider.getSetSize(el.element, index, listLength);\n      },\n      getRole: options.ariaProvider.getRole ? function (el) {\n        return options.ariaProvider.getRole(el.element);\n      } : undefined,\n      isChecked: options.ariaProvider.isChecked ? function (e) {\n        var _a;\n        return ((_a = options.ariaProvider) === null || _a === void 0 ? void 0 : _a.isChecked)(e.element);\n      } : undefined\n    },\n    additionalScrollHeight: options.additionalScrollHeight\n  });\n}\nfunction dfs(node, fn) {\n  fn(node);\n  node.children.forEach(function (child) {\n    return dfs(child, fn);\n  });\n}\nvar AsyncDataTree = /** @class */function () {\n  function AsyncDataTree(user, container, delegate, renderers, dataSource, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    this.user = user;\n    this.dataSource = dataSource;\n    this.nodes = new Map();\n    this.subTreeRefreshPromises = new Map();\n    this.refreshPromises = new Map();\n    this._onDidRender = new Emitter();\n    this._onDidChangeNodeSlowState = new Emitter();\n    this.nodeMapper = new WeakMapper(function (node) {\n      return new AsyncDataTreeNodeWrapper(node);\n    });\n    this.disposables = new DisposableStore();\n    this.identityProvider = options.identityProvider;\n    this.autoExpandSingleChildren = typeof options.autoExpandSingleChildren === 'undefined' ? false : options.autoExpandSingleChildren;\n    this.sorter = options.sorter;\n    this.collapseByDefault = options.collapseByDefault;\n    this.tree = this.createTree(user, container, delegate, renderers, options);\n    this.root = createAsyncDataTreeNode({\n      element: undefined,\n      parent: null,\n      hasChildren: true\n    });\n    if (this.identityProvider) {\n      this.root = __assign(__assign({}, this.root), {\n        id: null\n      });\n    }\n    this.nodes.set(null, this.root);\n    this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState, this, this.disposables);\n  }\n  Object.defineProperty(AsyncDataTree.prototype, \"onDidChangeFocus\", {\n    get: function get() {\n      return Event.map(this.tree.onDidChangeFocus, asTreeEvent);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTree.prototype, \"onDidChangeSelection\", {\n    get: function get() {\n      return Event.map(this.tree.onDidChangeSelection, asTreeEvent);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTree.prototype, \"onDidOpen\", {\n    get: function get() {\n      return Event.map(this.tree.onDidOpen, asTreeEvent);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTree.prototype, \"onDidFocus\", {\n    get: function get() {\n      return this.tree.onDidFocus;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AsyncDataTree.prototype, \"onDidDispose\", {\n    get: function get() {\n      return this.tree.onDidDispose;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  AsyncDataTree.prototype.createTree = function (user, container, delegate, renderers, options) {\n    var _this = this;\n    var objectTreeDelegate = new ComposedTreeDelegate(delegate);\n    var objectTreeRenderers = renderers.map(function (r) {\n      return new AsyncDataTreeRenderer(r, _this.nodeMapper, _this._onDidChangeNodeSlowState.event);\n    });\n    var objectTreeOptions = asObjectTreeOptions(options) || {};\n    return new ObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\n  };\n  AsyncDataTree.prototype.updateOptions = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n    this.tree.updateOptions(options);\n  };\n  // Widget\n  AsyncDataTree.prototype.getHTMLElement = function () {\n    return this.tree.getHTMLElement();\n  };\n  Object.defineProperty(AsyncDataTree.prototype, \"scrollTop\", {\n    get: function get() {\n      return this.tree.scrollTop;\n    },\n    set: function set(scrollTop) {\n      this.tree.scrollTop = scrollTop;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  AsyncDataTree.prototype.domFocus = function () {\n    this.tree.domFocus();\n  };\n  AsyncDataTree.prototype.layout = function (height, width) {\n    this.tree.layout(height, width);\n  };\n  AsyncDataTree.prototype.style = function (styles) {\n    this.tree.style(styles);\n  };\n  // Model\n  AsyncDataTree.prototype.getInput = function () {\n    return this.root.element;\n  };\n  AsyncDataTree.prototype.setInput = function (input, viewState) {\n    return __awaiter(this, void 0, void 0, function () {\n      var viewStateContext;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.refreshPromises.forEach(function (promise) {\n              return promise.cancel();\n            });\n            this.refreshPromises.clear();\n            this.root.element = input;\n            viewStateContext = viewState && {\n              viewState: viewState,\n              focus: [],\n              selection: []\n            };\n            return [4 /*yield*/, this._updateChildren(input, true, false, viewStateContext)];\n          case 1:\n            _a.sent();\n            if (viewStateContext) {\n              this.tree.setFocus(viewStateContext.focus);\n              this.tree.setSelection(viewStateContext.selection);\n            }\n            if (viewState && typeof viewState.scrollTop === 'number') {\n              this.scrollTop = viewState.scrollTop;\n            }\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AsyncDataTree.prototype._updateChildren = function (element, recursive, rerender, viewStateContext) {\n    if (element === void 0) {\n      element = this.root.element;\n    }\n    if (recursive === void 0) {\n      recursive = true;\n    }\n    if (rerender === void 0) {\n      rerender = false;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var node;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (typeof this.root.element === 'undefined') {\n              throw new TreeError(this.user, 'Tree input not set');\n            }\n            if (!this.root.refreshPromise) return [3 /*break*/, 3];\n            return [4 /*yield*/, this.root.refreshPromise];\n          case 1:\n            _a.sent();\n            return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\n          case 2:\n            _a.sent();\n            _a.label = 3;\n          case 3:\n            node = this.getDataNode(element);\n            return [4 /*yield*/, this.refreshAndRenderNode(node, recursive, viewStateContext)];\n          case 4:\n            _a.sent();\n            if (rerender) {\n              try {\n                this.tree.rerender(node);\n              } catch (_b) {\n                // missing nodes are fine, this could've resulted from\n                // parallel refresh calls, removing `node` altogether\n              }\n            }\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  // View\n  AsyncDataTree.prototype.rerender = function (element) {\n    if (element === undefined || element === this.root.element) {\n      this.tree.rerender();\n      return;\n    }\n    var node = this.getDataNode(element);\n    this.tree.rerender(node);\n  };\n  AsyncDataTree.prototype.collapse = function (element, recursive) {\n    if (recursive === void 0) {\n      recursive = false;\n    }\n    var node = this.getDataNode(element);\n    return this.tree.collapse(node === this.root ? null : node, recursive);\n  };\n  AsyncDataTree.prototype.expand = function (element, recursive) {\n    if (recursive === void 0) {\n      recursive = false;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n      var node, result;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (typeof this.root.element === 'undefined') {\n              throw new TreeError(this.user, 'Tree input not set');\n            }\n            if (!this.root.refreshPromise) return [3 /*break*/, 3];\n            return [4 /*yield*/, this.root.refreshPromise];\n          case 1:\n            _a.sent();\n            return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\n          case 2:\n            _a.sent();\n            _a.label = 3;\n          case 3:\n            node = this.getDataNode(element);\n            if (this.tree.hasElement(node) && !this.tree.isCollapsible(node)) {\n              return [2 /*return*/, false];\n            }\n            if (!node.refreshPromise) return [3 /*break*/, 6];\n            return [4 /*yield*/, this.root.refreshPromise];\n          case 4:\n            _a.sent();\n            return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\n          case 5:\n            _a.sent();\n            _a.label = 6;\n          case 6:\n            if (node !== this.root && !node.refreshPromise && !this.tree.isCollapsed(node)) {\n              return [2 /*return*/, false];\n            }\n            result = this.tree.expand(node === this.root ? null : node, recursive);\n            if (!node.refreshPromise) return [3 /*break*/, 9];\n            return [4 /*yield*/, this.root.refreshPromise];\n          case 7:\n            _a.sent();\n            return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\n          case 8:\n            _a.sent();\n            _a.label = 9;\n          case 9:\n            return [2 /*return*/, result];\n        }\n      });\n    });\n  };\n  AsyncDataTree.prototype.setSelection = function (elements, browserEvent) {\n    var _this = this;\n    var nodes = elements.map(function (e) {\n      return _this.getDataNode(e);\n    });\n    this.tree.setSelection(nodes, browserEvent);\n  };\n  AsyncDataTree.prototype.getSelection = function () {\n    var nodes = this.tree.getSelection();\n    return nodes.map(function (n) {\n      return n.element;\n    });\n  };\n  AsyncDataTree.prototype.setFocus = function (elements, browserEvent) {\n    var _this = this;\n    var nodes = elements.map(function (e) {\n      return _this.getDataNode(e);\n    });\n    this.tree.setFocus(nodes, browserEvent);\n  };\n  AsyncDataTree.prototype.getFocus = function () {\n    var nodes = this.tree.getFocus();\n    return nodes.map(function (n) {\n      return n.element;\n    });\n  };\n  AsyncDataTree.prototype.reveal = function (element, relativeTop) {\n    this.tree.reveal(this.getDataNode(element), relativeTop);\n  };\n  // Implementation\n  AsyncDataTree.prototype.getDataNode = function (element) {\n    var node = this.nodes.get(element === this.root.element ? null : element);\n    if (!node) {\n      throw new TreeError(this.user, \"Data tree node not found: \" + element);\n    }\n    return node;\n  };\n  AsyncDataTree.prototype.refreshAndRenderNode = function (node, recursive, viewStateContext) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.refreshNode(node, recursive, viewStateContext)];\n          case 1:\n            _a.sent();\n            this.render(node, viewStateContext);\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AsyncDataTree.prototype.refreshNode = function (node, recursive, viewStateContext) {\n    return __awaiter(this, void 0, void 0, function () {\n      var result;\n      var _this = this;\n      return __generator(this, function (_a) {\n        this.subTreeRefreshPromises.forEach(function (refreshPromise, refreshNode) {\n          if (!result && intersects(refreshNode, node)) {\n            result = refreshPromise.then(function () {\n              return _this.refreshNode(node, recursive, viewStateContext);\n            });\n          }\n        });\n        if (result) {\n          return [2 /*return*/, result];\n        }\n        return [2 /*return*/, this.doRefreshSubTree(node, recursive, viewStateContext)];\n      });\n    });\n  };\n  AsyncDataTree.prototype.doRefreshSubTree = function (node, recursive, viewStateContext) {\n    return __awaiter(this, void 0, void 0, function () {\n      var done, childrenToRefresh;\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            node.refreshPromise = new Promise(function (c) {\n              return done = c;\n            });\n            this.subTreeRefreshPromises.set(node, node.refreshPromise);\n            node.refreshPromise.finally(function () {\n              node.refreshPromise = undefined;\n              _this.subTreeRefreshPromises.delete(node);\n            });\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1,, 4, 5]);\n            return [4 /*yield*/, this.doRefreshNode(node, recursive, viewStateContext)];\n          case 2:\n            childrenToRefresh = _a.sent();\n            node.stale = false;\n            return [4 /*yield*/, Promise.all(childrenToRefresh.map(function (child) {\n              return _this.doRefreshSubTree(child, recursive, viewStateContext);\n            }))];\n          case 3:\n            _a.sent();\n            return [3 /*break*/, 5];\n          case 4:\n            done();\n            return [7 /*endfinally*/];\n          case 5:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AsyncDataTree.prototype.doRefreshNode = function (node, recursive, viewStateContext) {\n    return __awaiter(this, void 0, void 0, function () {\n      var childrenPromise, slowTimeout_1, children, err_1;\n      var _this = this;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            node.hasChildren = !!this.dataSource.hasChildren(node.element);\n            if (!node.hasChildren) {\n              childrenPromise = Promise.resolve([]);\n            } else {\n              slowTimeout_1 = timeout(800);\n              slowTimeout_1.then(function () {\n                node.slow = true;\n                _this._onDidChangeNodeSlowState.fire(node);\n              }, function (_) {\n                return null;\n              });\n              childrenPromise = this.doGetChildren(node).finally(function () {\n                return slowTimeout_1.cancel();\n              });\n            }\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3, 4, 5]);\n            return [4 /*yield*/, childrenPromise];\n          case 2:\n            children = _a.sent();\n            return [2 /*return*/, this.setChildren(node, children, recursive, viewStateContext)];\n          case 3:\n            err_1 = _a.sent();\n            if (node !== this.root) {\n              this.tree.collapse(node === this.root ? null : node);\n            }\n            if (isPromiseCanceledError(err_1)) {\n              return [2 /*return*/, []];\n            }\n            throw err_1;\n          case 4:\n            if (node.slow) {\n              node.slow = false;\n              this._onDidChangeNodeSlowState.fire(node);\n            }\n            return [7 /*endfinally*/];\n          case 5:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  AsyncDataTree.prototype.doGetChildren = function (node) {\n    var _this = this;\n    var result = this.refreshPromises.get(node);\n    if (result) {\n      return result;\n    }\n    result = createCancelablePromise(function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var children;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              return [4 /*yield*/, this.dataSource.getChildren(node.element)];\n            case 1:\n              children = _a.sent();\n              return [2 /*return*/, this.processChildren(children)];\n          }\n        });\n      });\n    });\n    this.refreshPromises.set(node, result);\n    return result.finally(function () {\n      return _this.refreshPromises.delete(node);\n    });\n  };\n  AsyncDataTree.prototype._onDidChangeCollapseState = function (_a) {\n    var node = _a.node,\n      deep = _a.deep;\n    if (!node.collapsed && node.element.stale) {\n      if (deep) {\n        this.collapse(node.element.element);\n      } else {\n        this.refreshAndRenderNode(node.element, false).catch(onUnexpectedError);\n      }\n    }\n  };\n  AsyncDataTree.prototype.setChildren = function (node, childrenElements, recursive, viewStateContext) {\n    var _a;\n    var _this = this;\n    // perf: if the node was and still is a leaf, avoid all this hassle\n    if (node.children.length === 0 && childrenElements.length === 0) {\n      return [];\n    }\n    var nodesToForget = new Map();\n    var childrenTreeNodesById = new Map();\n    for (var _i = 0, _b = node.children; _i < _b.length; _i++) {\n      var child = _b[_i];\n      nodesToForget.set(child.element, child);\n      if (this.identityProvider) {\n        var collapsed = this.tree.isCollapsed(child);\n        childrenTreeNodesById.set(child.id, {\n          node: child,\n          collapsed: collapsed\n        });\n      }\n    }\n    var childrenToRefresh = [];\n    var children = childrenElements.map(function (element) {\n      var hasChildren = !!_this.dataSource.hasChildren(element);\n      if (!_this.identityProvider) {\n        var asyncDataTreeNode = createAsyncDataTreeNode({\n          element: element,\n          parent: node,\n          hasChildren: hasChildren\n        });\n        if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\n          asyncDataTreeNode.collapsedByDefault = false;\n          childrenToRefresh.push(asyncDataTreeNode);\n        }\n        return asyncDataTreeNode;\n      }\n      var id = _this.identityProvider.getId(element).toString();\n      var result = childrenTreeNodesById.get(id);\n      if (result) {\n        var asyncDataTreeNode = result.node;\n        nodesToForget.delete(asyncDataTreeNode.element);\n        _this.nodes.delete(asyncDataTreeNode.element);\n        _this.nodes.set(element, asyncDataTreeNode);\n        asyncDataTreeNode.element = element;\n        asyncDataTreeNode.hasChildren = hasChildren;\n        if (recursive) {\n          if (result.collapsed) {\n            asyncDataTreeNode.children.forEach(function (node) {\n              return dfs(node, function (node) {\n                return _this.nodes.delete(node.element);\n              });\n            });\n            asyncDataTreeNode.children.splice(0, asyncDataTreeNode.children.length);\n            asyncDataTreeNode.stale = true;\n          } else {\n            childrenToRefresh.push(asyncDataTreeNode);\n          }\n        } else if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\n          asyncDataTreeNode.collapsedByDefault = false;\n          childrenToRefresh.push(asyncDataTreeNode);\n        }\n        return asyncDataTreeNode;\n      }\n      var childAsyncDataTreeNode = createAsyncDataTreeNode({\n        element: element,\n        parent: node,\n        id: id,\n        hasChildren: hasChildren\n      });\n      if (viewStateContext && viewStateContext.viewState.focus && viewStateContext.viewState.focus.indexOf(id) > -1) {\n        viewStateContext.focus.push(childAsyncDataTreeNode);\n      }\n      if (viewStateContext && viewStateContext.viewState.selection && viewStateContext.viewState.selection.indexOf(id) > -1) {\n        viewStateContext.selection.push(childAsyncDataTreeNode);\n      }\n      if (viewStateContext && viewStateContext.viewState.expanded && viewStateContext.viewState.expanded.indexOf(id) > -1) {\n        childrenToRefresh.push(childAsyncDataTreeNode);\n      } else if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\n        childAsyncDataTreeNode.collapsedByDefault = false;\n        childrenToRefresh.push(childAsyncDataTreeNode);\n      }\n      return childAsyncDataTreeNode;\n    });\n    for (var _c = 0, _d = values(nodesToForget); _c < _d.length; _c++) {\n      var node_1 = _d[_c];\n      dfs(node_1, function (node) {\n        return _this.nodes.delete(node.element);\n      });\n    }\n    for (var _e = 0, children_1 = children; _e < children_1.length; _e++) {\n      var child = children_1[_e];\n      this.nodes.set(child.element, child);\n    }\n    (_a = node.children).splice.apply(_a, __spreadArrays([0, node.children.length], children));\n    // TODO@joao this doesn't take filter into account\n    if (node !== this.root && this.autoExpandSingleChildren && children.length === 1 && childrenToRefresh.length === 0) {\n      children[0].collapsedByDefault = false;\n      childrenToRefresh.push(children[0]);\n    }\n    return childrenToRefresh;\n  };\n  AsyncDataTree.prototype.render = function (node, viewStateContext) {\n    var _this = this;\n    var children = node.children.map(function (node) {\n      return _this.asTreeElement(node, viewStateContext);\n    });\n    this.tree.setChildren(node === this.root ? null : node, children);\n    if (node !== this.root) {\n      this.tree.setCollapsible(node, node.hasChildren);\n    }\n    this._onDidRender.fire();\n  };\n  AsyncDataTree.prototype.asTreeElement = function (node, viewStateContext) {\n    var _this = this;\n    if (node.stale) {\n      return {\n        element: node,\n        collapsible: node.hasChildren,\n        collapsed: true\n      };\n    }\n    var collapsed;\n    if (viewStateContext && viewStateContext.viewState.expanded && node.id && viewStateContext.viewState.expanded.indexOf(node.id) > -1) {\n      collapsed = false;\n    } else {\n      collapsed = node.collapsedByDefault;\n    }\n    node.collapsedByDefault = undefined;\n    return {\n      element: node,\n      children: node.hasChildren ? Iterator.map(Iterator.fromArray(node.children), function (child) {\n        return _this.asTreeElement(child, viewStateContext);\n      }) : [],\n      collapsible: node.hasChildren,\n      collapsed: collapsed\n    };\n  };\n  AsyncDataTree.prototype.processChildren = function (children) {\n    if (this.sorter) {\n      children.sort(this.sorter.compare.bind(this.sorter));\n    }\n    return children;\n  };\n  AsyncDataTree.prototype.dispose = function () {\n    this.disposables.dispose();\n  };\n  return AsyncDataTree;\n}();\nexport { AsyncDataTree };\nvar CompressibleAsyncDataTreeNodeWrapper = /** @class */function () {\n  function CompressibleAsyncDataTreeNodeWrapper(node) {\n    this.node = node;\n  }\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"element\", {\n    get: function get() {\n      return {\n        elements: this.node.element.elements.map(function (e) {\n          return e.element;\n        }),\n        incompressible: this.node.element.incompressible\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"children\", {\n    get: function get() {\n      return this.node.children.map(function (node) {\n        return new CompressibleAsyncDataTreeNodeWrapper(node);\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"depth\", {\n    get: function get() {\n      return this.node.depth;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visibleChildrenCount\", {\n    get: function get() {\n      return this.node.visibleChildrenCount;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visibleChildIndex\", {\n    get: function get() {\n      return this.node.visibleChildIndex;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"collapsible\", {\n    get: function get() {\n      return this.node.collapsible;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"collapsed\", {\n    get: function get() {\n      return this.node.collapsed;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visible\", {\n    get: function get() {\n      return this.node.visible;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"filterData\", {\n    get: function get() {\n      return this.node.filterData;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return CompressibleAsyncDataTreeNodeWrapper;\n}();\nvar CompressibleAsyncDataTreeRenderer = /** @class */function () {\n  function CompressibleAsyncDataTreeRenderer(renderer, nodeMapper, compressibleNodeMapperProvider, onDidChangeTwistieState) {\n    this.renderer = renderer;\n    this.nodeMapper = nodeMapper;\n    this.compressibleNodeMapperProvider = compressibleNodeMapperProvider;\n    this.onDidChangeTwistieState = onDidChangeTwistieState;\n    this.renderedNodes = new Map();\n    this.disposables = [];\n    this.templateId = renderer.templateId;\n  }\n  CompressibleAsyncDataTreeRenderer.prototype.renderTemplate = function (container) {\n    var templateData = this.renderer.renderTemplate(container);\n    return {\n      templateData: templateData\n    };\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.renderElement = function (node, index, templateData, height) {\n    this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.renderCompressedElements = function (node, index, templateData, height) {\n    this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.renderTwistie = function (element, twistieElement) {\n    toggleClass(twistieElement, 'codicon-loading', element.slow);\n    return false;\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.disposeElement = function (node, index, templateData, height) {\n    if (this.renderer.disposeElement) {\n      this.renderer.disposeElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.disposeCompressedElements = function (node, index, templateData, height) {\n    if (this.renderer.disposeCompressedElements) {\n      this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\n    }\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.disposeTemplate = function (templateData) {\n    this.renderer.disposeTemplate(templateData.templateData);\n  };\n  CompressibleAsyncDataTreeRenderer.prototype.dispose = function () {\n    this.renderedNodes.clear();\n    this.disposables = dispose(this.disposables);\n  };\n  return CompressibleAsyncDataTreeRenderer;\n}();\nfunction asCompressibleObjectTreeOptions(options) {\n  var objectTreeOptions = options && asObjectTreeOptions(options);\n  return objectTreeOptions && __assign(__assign({}, objectTreeOptions), {\n    keyboardNavigationLabelProvider: objectTreeOptions.keyboardNavigationLabelProvider && __assign(__assign({}, objectTreeOptions.keyboardNavigationLabelProvider), {\n      getCompressedNodeKeyboardNavigationLabel: function getCompressedNodeKeyboardNavigationLabel(els) {\n        return options.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(els.map(function (e) {\n          return e.element;\n        }));\n      }\n    })\n  });\n}\nvar CompressibleAsyncDataTree = /** @class */function (_super) {\n  __extends(CompressibleAsyncDataTree, _super);\n  function CompressibleAsyncDataTree(user, container, virtualDelegate, compressionDelegate, renderers, dataSource, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    var _this = _super.call(this, user, container, virtualDelegate, renderers, dataSource, options) || this;\n    _this.compressionDelegate = compressionDelegate;\n    _this.compressibleNodeMapper = new WeakMapper(function (node) {\n      return new CompressibleAsyncDataTreeNodeWrapper(node);\n    });\n    _this.filter = options.filter;\n    return _this;\n  }\n  CompressibleAsyncDataTree.prototype.createTree = function (user, container, delegate, renderers, options) {\n    var _this = this;\n    var objectTreeDelegate = new ComposedTreeDelegate(delegate);\n    var objectTreeRenderers = renderers.map(function (r) {\n      return new CompressibleAsyncDataTreeRenderer(r, _this.nodeMapper, function () {\n        return _this.compressibleNodeMapper;\n      }, _this._onDidChangeNodeSlowState.event);\n    });\n    var objectTreeOptions = asCompressibleObjectTreeOptions(options) || {};\n    return new CompressibleObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\n  };\n  CompressibleAsyncDataTree.prototype.asTreeElement = function (node, viewStateContext) {\n    return __assign({\n      incompressible: this.compressionDelegate.isIncompressible(node.element)\n    }, _super.prototype.asTreeElement.call(this, node, viewStateContext));\n  };\n  CompressibleAsyncDataTree.prototype.updateOptions = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n    this.tree.updateOptions(options);\n  };\n  CompressibleAsyncDataTree.prototype.render = function (node, viewStateContext) {\n    var _this = this;\n    if (!this.identityProvider) {\n      return _super.prototype.render.call(this, node, viewStateContext);\n    }\n    // Preserve traits across compressions. Hacky but does the trick.\n    // This is hard to fix properly since it requires rewriting the traits\n    // across trees and lists. Let's just keep it this way for now.\n    var getId = function getId(element) {\n      return _this.identityProvider.getId(element).toString();\n    };\n    var getUncompressedIds = function getUncompressedIds(nodes) {\n      var result = new Set();\n      for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n        var node_2 = nodes_1[_i];\n        var compressedNode = _this.tree.getCompressedTreeNode(node_2 === _this.root ? null : node_2);\n        if (!compressedNode.element) {\n          continue;\n        }\n        for (var _a = 0, _b = compressedNode.element.elements; _a < _b.length; _a++) {\n          var node_3 = _b[_a];\n          result.add(getId(node_3.element));\n        }\n      }\n      return result;\n    };\n    var oldSelection = getUncompressedIds(this.tree.getSelection());\n    var oldFocus = getUncompressedIds(this.tree.getFocus());\n    _super.prototype.render.call(this, node, viewStateContext);\n    var selection = this.getSelection();\n    var didChangeSelection = false;\n    var focus = this.getFocus();\n    var didChangeFocus = false;\n    var visit = function visit(node) {\n      var compressedNode = node.element;\n      if (compressedNode) {\n        for (var i = 0; i < compressedNode.elements.length; i++) {\n          var id = getId(compressedNode.elements[i].element);\n          var element = compressedNode.elements[compressedNode.elements.length - 1].element;\n          // github.com/microsoft/vscode/issues/85938\n          if (oldSelection.has(id) && selection.indexOf(element) === -1) {\n            selection.push(element);\n            didChangeSelection = true;\n          }\n          if (oldFocus.has(id) && focus.indexOf(element) === -1) {\n            focus.push(element);\n            didChangeFocus = true;\n          }\n        }\n      }\n      node.children.forEach(visit);\n    };\n    visit(this.tree.getCompressedTreeNode(node === this.root ? null : node));\n    if (didChangeSelection) {\n      this.setSelection(selection);\n    }\n    if (didChangeFocus) {\n      this.setFocus(focus);\n    }\n  };\n  // For compressed async data trees, `TreeVisibility.Recurse` doesn't currently work\n  // and we have to filter everything beforehand\n  // Related to #85193 and #85835\n  CompressibleAsyncDataTree.prototype.processChildren = function (children) {\n    var _this = this;\n    if (this.filter) {\n      children = children.filter(function (e) {\n        var result = _this.filter.filter(e, 1 /* Visible */);\n        var visibility = getVisibility(result);\n        if (visibility === 2 /* Recurse */) {\n          throw new Error('Recursive tree visibility not supported in async data compressed trees');\n        }\n        return visibility === 1 /* Visible */;\n      });\n    }\n\n    return _super.prototype.processChildren.call(this, children);\n  };\n  return CompressibleAsyncDataTree;\n}(AsyncDataTree);\nexport { CompressibleAsyncDataTree };\nfunction getVisibility(filterResult) {\n  if (typeof filterResult === 'boolean') {\n    return filterResult ? 1 /* Visible */ : 0 /* Hidden */;\n  } else if (isFilterResult(filterResult)) {\n    return getVisibleState(filterResult.visibility);\n  } else {\n    return getVisibleState(filterResult);\n  }\n}","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArrays","il","r","k","a","j","jl","ComposedTreeDelegate","ObjectTree","CompressibleObjectTree","TreeError","WeakMapper","dispose","DisposableStore","Emitter","Event","timeout","createCancelablePromise","Iterator","ElementsDragAndDropData","isPromiseCanceledError","onUnexpectedError","toggleClass","values","isFilterResult","getVisibleState","createAsyncDataTreeNode","props","children","refreshPromise","undefined","stale","slow","collapsedByDefault","isAncestor","ancestor","descendant","parent","intersects","node","other","AsyncDataTreeNodeWrapper","defineProperty","get","element","enumerable","configurable","map","depth","visibleChildrenCount","visibleChildIndex","collapsible","collapsed","visible","filterData","AsyncDataTreeRenderer","renderer","nodeMapper","onDidChangeTwistieState","renderedNodes","Map","templateId","renderTemplate","container","templateData","renderElement","index","height","renderTwistie","twistieElement","disposeElement","disposeTemplate","clear","asTreeEvent","browserEvent","elements","AsyncDataTreeElementsDragAndDropData","_super","data","_this","asAsyncDataTreeDragAndDropData","AsyncDataTreeNodeListDragAndDrop","dnd","getDragURI","getDragLabel","nodes","originalEvent","onDragStart","onDragOver","targetNode","targetIndex","raw","drop","onDragEnd","asObjectTreeOptions","options","collapseByDefault","identityProvider","getId","el","multipleSelectionController","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","accessibilityProvider","getAriaLabel","getAriaLevel","getActiveDescendantId","filter","parentVisibility","keyboardNavigationLabelProvider","getKeyboardNavigationLabel","sorter","expandOnlyOnTwistieClick","ariaProvider","getPosInSet","getSetSize","listLength","getRole","isChecked","_a","additionalScrollHeight","dfs","fn","forEach","child","AsyncDataTree","user","delegate","renderers","dataSource","subTreeRefreshPromises","refreshPromises","_onDidRender","_onDidChangeNodeSlowState","disposables","autoExpandSingleChildren","tree","createTree","root","hasChildren","id","set","onDidChangeCollapseState","_onDidChangeCollapseState","onDidChangeFocus","onDidChangeSelection","onDidOpen","onDidFocus","onDidDispose","objectTreeDelegate","objectTreeRenderers","event","objectTreeOptions","updateOptions","getHTMLElement","scrollTop","domFocus","layout","width","style","styles","getInput","setInput","input","viewState","viewStateContext","promise","cancel","focus","selection","_updateChildren","setFocus","setSelection","recursive","rerender","toPromise","getDataNode","refreshAndRenderNode","_b","collapse","expand","hasElement","isCollapsible","isCollapsed","getSelection","getFocus","reveal","relativeTop","refreshNode","render","doRefreshSubTree","childrenToRefresh","c","finally","delete","doRefreshNode","all","childrenPromise","slowTimeout_1","err_1","fire","doGetChildren","setChildren","getChildren","processChildren","deep","catch","childrenElements","nodesToForget","childrenTreeNodesById","_i","asyncDataTreeNode","toString","splice","childAsyncDataTreeNode","indexOf","expanded","_c","_d","node_1","_e","children_1","asTreeElement","setCollapsible","fromArray","sort","compare","bind","CompressibleAsyncDataTreeNodeWrapper","incompressible","CompressibleAsyncDataTreeRenderer","compressibleNodeMapperProvider","renderCompressedElements","disposeCompressedElements","asCompressibleObjectTreeOptions","getCompressedNodeKeyboardNavigationLabel","els","CompressibleAsyncDataTree","virtualDelegate","compressionDelegate","compressibleNodeMapper","isIncompressible","getUncompressedIds","Set","nodes_1","node_2","compressedNode","getCompressedTreeNode","node_3","add","oldSelection","oldFocus","didChangeSelection","didChangeFocus","visit","has","visibility","getVisibility","Error","filterResult"],"sources":["C:/Users/akash/Desktop/agat project/CLientapp/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/asyncDataTree.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { ComposedTreeDelegate } from './abstractTree.js';\r\nimport { ObjectTree, CompressibleObjectTree } from './objectTree.js';\r\nimport { TreeError, WeakMapper } from './tree.js';\r\nimport { dispose, DisposableStore } from '../../../common/lifecycle.js';\r\nimport { Emitter, Event } from '../../../common/event.js';\r\nimport { timeout, createCancelablePromise } from '../../../common/async.js';\r\nimport { Iterator } from '../../../common/iterator.js';\r\nimport { ElementsDragAndDropData } from '../list/listView.js';\r\nimport { isPromiseCanceledError, onUnexpectedError } from '../../../common/errors.js';\r\nimport { toggleClass } from '../../dom.js';\r\nimport { values } from '../../../common/map.js';\r\nimport { isFilterResult, getVisibleState } from './indexTreeModel.js';\r\nfunction createAsyncDataTreeNode(props) {\r\n    return __assign(__assign({}, props), { children: [], refreshPromise: undefined, stale: true, slow: false, collapsedByDefault: undefined });\r\n}\r\nfunction isAncestor(ancestor, descendant) {\r\n    if (!descendant.parent) {\r\n        return false;\r\n    }\r\n    else if (descendant.parent === ancestor) {\r\n        return true;\r\n    }\r\n    else {\r\n        return isAncestor(ancestor, descendant.parent);\r\n    }\r\n}\r\nfunction intersects(node, other) {\r\n    return node === other || isAncestor(node, other) || isAncestor(other, node);\r\n}\r\nvar AsyncDataTreeNodeWrapper = /** @class */ (function () {\r\n    function AsyncDataTreeNodeWrapper(node) {\r\n        this.node = node;\r\n    }\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"element\", {\r\n        get: function () { return this.node.element.element; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"children\", {\r\n        get: function () { return this.node.children.map(function (node) { return new AsyncDataTreeNodeWrapper(node); }); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"depth\", {\r\n        get: function () { return this.node.depth; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visibleChildrenCount\", {\r\n        get: function () { return this.node.visibleChildrenCount; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visibleChildIndex\", {\r\n        get: function () { return this.node.visibleChildIndex; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"collapsible\", {\r\n        get: function () { return this.node.collapsible; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"collapsed\", {\r\n        get: function () { return this.node.collapsed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"visible\", {\r\n        get: function () { return this.node.visible; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTreeNodeWrapper.prototype, \"filterData\", {\r\n        get: function () { return this.node.filterData; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return AsyncDataTreeNodeWrapper;\r\n}());\r\nvar AsyncDataTreeRenderer = /** @class */ (function () {\r\n    function AsyncDataTreeRenderer(renderer, nodeMapper, onDidChangeTwistieState) {\r\n        this.renderer = renderer;\r\n        this.nodeMapper = nodeMapper;\r\n        this.onDidChangeTwistieState = onDidChangeTwistieState;\r\n        this.renderedNodes = new Map();\r\n        this.templateId = renderer.templateId;\r\n    }\r\n    AsyncDataTreeRenderer.prototype.renderTemplate = function (container) {\r\n        var templateData = this.renderer.renderTemplate(container);\r\n        return { templateData: templateData };\r\n    };\r\n    AsyncDataTreeRenderer.prototype.renderElement = function (node, index, templateData, height) {\r\n        this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\r\n    };\r\n    AsyncDataTreeRenderer.prototype.renderTwistie = function (element, twistieElement) {\r\n        toggleClass(twistieElement, 'codicon-loading', element.slow);\r\n        return false;\r\n    };\r\n    AsyncDataTreeRenderer.prototype.disposeElement = function (node, index, templateData, height) {\r\n        if (this.renderer.disposeElement) {\r\n            this.renderer.disposeElement(this.nodeMapper.map(node), index, templateData.templateData, height);\r\n        }\r\n    };\r\n    AsyncDataTreeRenderer.prototype.disposeTemplate = function (templateData) {\r\n        this.renderer.disposeTemplate(templateData.templateData);\r\n    };\r\n    AsyncDataTreeRenderer.prototype.dispose = function () {\r\n        this.renderedNodes.clear();\r\n    };\r\n    return AsyncDataTreeRenderer;\r\n}());\r\nfunction asTreeEvent(e) {\r\n    return {\r\n        browserEvent: e.browserEvent,\r\n        elements: e.elements.map(function (e) { return e.element; })\r\n    };\r\n}\r\nvar AsyncDataTreeElementsDragAndDropData = /** @class */ (function (_super) {\r\n    __extends(AsyncDataTreeElementsDragAndDropData, _super);\r\n    function AsyncDataTreeElementsDragAndDropData(data) {\r\n        var _this = _super.call(this, data.elements.map(function (node) { return node.element; })) || this;\r\n        _this.data = data;\r\n        return _this;\r\n    }\r\n    return AsyncDataTreeElementsDragAndDropData;\r\n}(ElementsDragAndDropData));\r\nfunction asAsyncDataTreeDragAndDropData(data) {\r\n    if (data instanceof ElementsDragAndDropData) {\r\n        return new AsyncDataTreeElementsDragAndDropData(data);\r\n    }\r\n    return data;\r\n}\r\nvar AsyncDataTreeNodeListDragAndDrop = /** @class */ (function () {\r\n    function AsyncDataTreeNodeListDragAndDrop(dnd) {\r\n        this.dnd = dnd;\r\n    }\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.getDragURI = function (node) {\r\n        return this.dnd.getDragURI(node.element);\r\n    };\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.getDragLabel = function (nodes, originalEvent) {\r\n        if (this.dnd.getDragLabel) {\r\n            return this.dnd.getDragLabel(nodes.map(function (node) { return node.element; }), originalEvent);\r\n        }\r\n        return undefined;\r\n    };\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.onDragStart = function (data, originalEvent) {\r\n        if (this.dnd.onDragStart) {\r\n            this.dnd.onDragStart(asAsyncDataTreeDragAndDropData(data), originalEvent);\r\n        }\r\n    };\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.onDragOver = function (data, targetNode, targetIndex, originalEvent, raw) {\r\n        if (raw === void 0) { raw = true; }\r\n        return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\r\n    };\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.drop = function (data, targetNode, targetIndex, originalEvent) {\r\n        this.dnd.drop(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\r\n    };\r\n    AsyncDataTreeNodeListDragAndDrop.prototype.onDragEnd = function (originalEvent) {\r\n        if (this.dnd.onDragEnd) {\r\n            this.dnd.onDragEnd(originalEvent);\r\n        }\r\n    };\r\n    return AsyncDataTreeNodeListDragAndDrop;\r\n}());\r\nfunction asObjectTreeOptions(options) {\r\n    return options && __assign(__assign({}, options), { collapseByDefault: true, identityProvider: options.identityProvider && {\r\n            getId: function (el) {\r\n                return options.identityProvider.getId(el.element);\r\n            }\r\n        }, dnd: options.dnd && new AsyncDataTreeNodeListDragAndDrop(options.dnd), multipleSelectionController: options.multipleSelectionController && {\r\n            isSelectionSingleChangeEvent: function (e) {\r\n                return options.multipleSelectionController.isSelectionSingleChangeEvent(__assign(__assign({}, e), { element: e.element }));\r\n            },\r\n            isSelectionRangeChangeEvent: function (e) {\r\n                return options.multipleSelectionController.isSelectionRangeChangeEvent(__assign(__assign({}, e), { element: e.element }));\r\n            }\r\n        }, accessibilityProvider: options.accessibilityProvider && __assign(__assign({}, options.accessibilityProvider), { getAriaLabel: function (e) {\r\n                return options.accessibilityProvider.getAriaLabel(e.element);\r\n            }, getAriaLevel: options.accessibilityProvider.getAriaLevel && (function (node) {\r\n                return options.accessibilityProvider.getAriaLevel(node.element);\r\n            }), getActiveDescendantId: options.accessibilityProvider.getActiveDescendantId && (function (node) {\r\n                return options.accessibilityProvider.getActiveDescendantId(node.element);\r\n            }) }), filter: options.filter && {\r\n            filter: function (e, parentVisibility) {\r\n                return options.filter.filter(e.element, parentVisibility);\r\n            }\r\n        }, keyboardNavigationLabelProvider: options.keyboardNavigationLabelProvider && __assign(__assign({}, options.keyboardNavigationLabelProvider), { getKeyboardNavigationLabel: function (e) {\r\n                return options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element);\r\n            } }), sorter: undefined, expandOnlyOnTwistieClick: typeof options.expandOnlyOnTwistieClick === 'undefined' ? undefined : (typeof options.expandOnlyOnTwistieClick !== 'function' ? options.expandOnlyOnTwistieClick : (function (e) { return options.expandOnlyOnTwistieClick(e.element); })), ariaProvider: options.ariaProvider && {\r\n            getPosInSet: function (el, index) {\r\n                return options.ariaProvider.getPosInSet(el.element, index);\r\n            },\r\n            getSetSize: function (el, index, listLength) {\r\n                return options.ariaProvider.getSetSize(el.element, index, listLength);\r\n            },\r\n            getRole: options.ariaProvider.getRole ? function (el) {\r\n                return options.ariaProvider.getRole(el.element);\r\n            } : undefined,\r\n            isChecked: options.ariaProvider.isChecked ? function (e) {\r\n                var _a;\r\n                return ((_a = options.ariaProvider) === null || _a === void 0 ? void 0 : _a.isChecked)(e.element);\r\n            } : undefined\r\n        }, additionalScrollHeight: options.additionalScrollHeight });\r\n}\r\nfunction dfs(node, fn) {\r\n    fn(node);\r\n    node.children.forEach(function (child) { return dfs(child, fn); });\r\n}\r\nvar AsyncDataTree = /** @class */ (function () {\r\n    function AsyncDataTree(user, container, delegate, renderers, dataSource, options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.user = user;\r\n        this.dataSource = dataSource;\r\n        this.nodes = new Map();\r\n        this.subTreeRefreshPromises = new Map();\r\n        this.refreshPromises = new Map();\r\n        this._onDidRender = new Emitter();\r\n        this._onDidChangeNodeSlowState = new Emitter();\r\n        this.nodeMapper = new WeakMapper(function (node) { return new AsyncDataTreeNodeWrapper(node); });\r\n        this.disposables = new DisposableStore();\r\n        this.identityProvider = options.identityProvider;\r\n        this.autoExpandSingleChildren = typeof options.autoExpandSingleChildren === 'undefined' ? false : options.autoExpandSingleChildren;\r\n        this.sorter = options.sorter;\r\n        this.collapseByDefault = options.collapseByDefault;\r\n        this.tree = this.createTree(user, container, delegate, renderers, options);\r\n        this.root = createAsyncDataTreeNode({\r\n            element: undefined,\r\n            parent: null,\r\n            hasChildren: true\r\n        });\r\n        if (this.identityProvider) {\r\n            this.root = __assign(__assign({}, this.root), { id: null });\r\n        }\r\n        this.nodes.set(null, this.root);\r\n        this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState, this, this.disposables);\r\n    }\r\n    Object.defineProperty(AsyncDataTree.prototype, \"onDidChangeFocus\", {\r\n        get: function () { return Event.map(this.tree.onDidChangeFocus, asTreeEvent); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTree.prototype, \"onDidChangeSelection\", {\r\n        get: function () { return Event.map(this.tree.onDidChangeSelection, asTreeEvent); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTree.prototype, \"onDidOpen\", {\r\n        get: function () { return Event.map(this.tree.onDidOpen, asTreeEvent); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTree.prototype, \"onDidFocus\", {\r\n        get: function () { return this.tree.onDidFocus; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AsyncDataTree.prototype, \"onDidDispose\", {\r\n        get: function () { return this.tree.onDidDispose; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AsyncDataTree.prototype.createTree = function (user, container, delegate, renderers, options) {\r\n        var _this = this;\r\n        var objectTreeDelegate = new ComposedTreeDelegate(delegate);\r\n        var objectTreeRenderers = renderers.map(function (r) { return new AsyncDataTreeRenderer(r, _this.nodeMapper, _this._onDidChangeNodeSlowState.event); });\r\n        var objectTreeOptions = asObjectTreeOptions(options) || {};\r\n        return new ObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\r\n    };\r\n    AsyncDataTree.prototype.updateOptions = function (options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.tree.updateOptions(options);\r\n    };\r\n    // Widget\r\n    AsyncDataTree.prototype.getHTMLElement = function () {\r\n        return this.tree.getHTMLElement();\r\n    };\r\n    Object.defineProperty(AsyncDataTree.prototype, \"scrollTop\", {\r\n        get: function () {\r\n            return this.tree.scrollTop;\r\n        },\r\n        set: function (scrollTop) {\r\n            this.tree.scrollTop = scrollTop;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AsyncDataTree.prototype.domFocus = function () {\r\n        this.tree.domFocus();\r\n    };\r\n    AsyncDataTree.prototype.layout = function (height, width) {\r\n        this.tree.layout(height, width);\r\n    };\r\n    AsyncDataTree.prototype.style = function (styles) {\r\n        this.tree.style(styles);\r\n    };\r\n    // Model\r\n    AsyncDataTree.prototype.getInput = function () {\r\n        return this.root.element;\r\n    };\r\n    AsyncDataTree.prototype.setInput = function (input, viewState) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var viewStateContext;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.refreshPromises.forEach(function (promise) { return promise.cancel(); });\r\n                        this.refreshPromises.clear();\r\n                        this.root.element = input;\r\n                        viewStateContext = viewState && { viewState: viewState, focus: [], selection: [] };\r\n                        return [4 /*yield*/, this._updateChildren(input, true, false, viewStateContext)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (viewStateContext) {\r\n                            this.tree.setFocus(viewStateContext.focus);\r\n                            this.tree.setSelection(viewStateContext.selection);\r\n                        }\r\n                        if (viewState && typeof viewState.scrollTop === 'number') {\r\n                            this.scrollTop = viewState.scrollTop;\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype._updateChildren = function (element, recursive, rerender, viewStateContext) {\r\n        if (element === void 0) { element = this.root.element; }\r\n        if (recursive === void 0) { recursive = true; }\r\n        if (rerender === void 0) { rerender = false; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var node;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (typeof this.root.element === 'undefined') {\r\n                            throw new TreeError(this.user, 'Tree input not set');\r\n                        }\r\n                        if (!this.root.refreshPromise) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, this.root.refreshPromise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        node = this.getDataNode(element);\r\n                        return [4 /*yield*/, this.refreshAndRenderNode(node, recursive, viewStateContext)];\r\n                    case 4:\r\n                        _a.sent();\r\n                        if (rerender) {\r\n                            try {\r\n                                this.tree.rerender(node);\r\n                            }\r\n                            catch (_b) {\r\n                                // missing nodes are fine, this could've resulted from\r\n                                // parallel refresh calls, removing `node` altogether\r\n                            }\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // View\r\n    AsyncDataTree.prototype.rerender = function (element) {\r\n        if (element === undefined || element === this.root.element) {\r\n            this.tree.rerender();\r\n            return;\r\n        }\r\n        var node = this.getDataNode(element);\r\n        this.tree.rerender(node);\r\n    };\r\n    AsyncDataTree.prototype.collapse = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        var node = this.getDataNode(element);\r\n        return this.tree.collapse(node === this.root ? null : node, recursive);\r\n    };\r\n    AsyncDataTree.prototype.expand = function (element, recursive) {\r\n        if (recursive === void 0) { recursive = false; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var node, result;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (typeof this.root.element === 'undefined') {\r\n                            throw new TreeError(this.user, 'Tree input not set');\r\n                        }\r\n                        if (!this.root.refreshPromise) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, this.root.refreshPromise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        node = this.getDataNode(element);\r\n                        if (this.tree.hasElement(node) && !this.tree.isCollapsible(node)) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        if (!node.refreshPromise) return [3 /*break*/, 6];\r\n                        return [4 /*yield*/, this.root.refreshPromise];\r\n                    case 4:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\r\n                    case 5:\r\n                        _a.sent();\r\n                        _a.label = 6;\r\n                    case 6:\r\n                        if (node !== this.root && !node.refreshPromise && !this.tree.isCollapsed(node)) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        result = this.tree.expand(node === this.root ? null : node, recursive);\r\n                        if (!node.refreshPromise) return [3 /*break*/, 9];\r\n                        return [4 /*yield*/, this.root.refreshPromise];\r\n                    case 7:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Event.toPromise(this._onDidRender.event)];\r\n                    case 8:\r\n                        _a.sent();\r\n                        _a.label = 9;\r\n                    case 9: return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype.setSelection = function (elements, browserEvent) {\r\n        var _this = this;\r\n        var nodes = elements.map(function (e) { return _this.getDataNode(e); });\r\n        this.tree.setSelection(nodes, browserEvent);\r\n    };\r\n    AsyncDataTree.prototype.getSelection = function () {\r\n        var nodes = this.tree.getSelection();\r\n        return nodes.map(function (n) { return n.element; });\r\n    };\r\n    AsyncDataTree.prototype.setFocus = function (elements, browserEvent) {\r\n        var _this = this;\r\n        var nodes = elements.map(function (e) { return _this.getDataNode(e); });\r\n        this.tree.setFocus(nodes, browserEvent);\r\n    };\r\n    AsyncDataTree.prototype.getFocus = function () {\r\n        var nodes = this.tree.getFocus();\r\n        return nodes.map(function (n) { return n.element; });\r\n    };\r\n    AsyncDataTree.prototype.reveal = function (element, relativeTop) {\r\n        this.tree.reveal(this.getDataNode(element), relativeTop);\r\n    };\r\n    // Implementation\r\n    AsyncDataTree.prototype.getDataNode = function (element) {\r\n        var node = this.nodes.get((element === this.root.element ? null : element));\r\n        if (!node) {\r\n            throw new TreeError(this.user, \"Data tree node not found: \" + element);\r\n        }\r\n        return node;\r\n    };\r\n    AsyncDataTree.prototype.refreshAndRenderNode = function (node, recursive, viewStateContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.refreshNode(node, recursive, viewStateContext)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.render(node, viewStateContext);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype.refreshNode = function (node, recursive, viewStateContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var result;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                this.subTreeRefreshPromises.forEach(function (refreshPromise, refreshNode) {\r\n                    if (!result && intersects(refreshNode, node)) {\r\n                        result = refreshPromise.then(function () { return _this.refreshNode(node, recursive, viewStateContext); });\r\n                    }\r\n                });\r\n                if (result) {\r\n                    return [2 /*return*/, result];\r\n                }\r\n                return [2 /*return*/, this.doRefreshSubTree(node, recursive, viewStateContext)];\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype.doRefreshSubTree = function (node, recursive, viewStateContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var done, childrenToRefresh;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        node.refreshPromise = new Promise(function (c) { return done = c; });\r\n                        this.subTreeRefreshPromises.set(node, node.refreshPromise);\r\n                        node.refreshPromise.finally(function () {\r\n                            node.refreshPromise = undefined;\r\n                            _this.subTreeRefreshPromises.delete(node);\r\n                        });\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, , 4, 5]);\r\n                        return [4 /*yield*/, this.doRefreshNode(node, recursive, viewStateContext)];\r\n                    case 2:\r\n                        childrenToRefresh = _a.sent();\r\n                        node.stale = false;\r\n                        return [4 /*yield*/, Promise.all(childrenToRefresh.map(function (child) { return _this.doRefreshSubTree(child, recursive, viewStateContext); }))];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        done();\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype.doRefreshNode = function (node, recursive, viewStateContext) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var childrenPromise, slowTimeout_1, children, err_1;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        node.hasChildren = !!this.dataSource.hasChildren(node.element);\r\n                        if (!node.hasChildren) {\r\n                            childrenPromise = Promise.resolve([]);\r\n                        }\r\n                        else {\r\n                            slowTimeout_1 = timeout(800);\r\n                            slowTimeout_1.then(function () {\r\n                                node.slow = true;\r\n                                _this._onDidChangeNodeSlowState.fire(node);\r\n                            }, function (_) { return null; });\r\n                            childrenPromise = this.doGetChildren(node)\r\n                                .finally(function () { return slowTimeout_1.cancel(); });\r\n                        }\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, 4, 5]);\r\n                        return [4 /*yield*/, childrenPromise];\r\n                    case 2:\r\n                        children = _a.sent();\r\n                        return [2 /*return*/, this.setChildren(node, children, recursive, viewStateContext)];\r\n                    case 3:\r\n                        err_1 = _a.sent();\r\n                        if (node !== this.root) {\r\n                            this.tree.collapse(node === this.root ? null : node);\r\n                        }\r\n                        if (isPromiseCanceledError(err_1)) {\r\n                            return [2 /*return*/, []];\r\n                        }\r\n                        throw err_1;\r\n                    case 4:\r\n                        if (node.slow) {\r\n                            node.slow = false;\r\n                            this._onDidChangeNodeSlowState.fire(node);\r\n                        }\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AsyncDataTree.prototype.doGetChildren = function (node) {\r\n        var _this = this;\r\n        var result = this.refreshPromises.get(node);\r\n        if (result) {\r\n            return result;\r\n        }\r\n        result = createCancelablePromise(function () { return __awaiter(_this, void 0, void 0, function () {\r\n            var children;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.dataSource.getChildren(node.element)];\r\n                    case 1:\r\n                        children = _a.sent();\r\n                        return [2 /*return*/, this.processChildren(children)];\r\n                }\r\n            });\r\n        }); });\r\n        this.refreshPromises.set(node, result);\r\n        return result.finally(function () { return _this.refreshPromises.delete(node); });\r\n    };\r\n    AsyncDataTree.prototype._onDidChangeCollapseState = function (_a) {\r\n        var node = _a.node, deep = _a.deep;\r\n        if (!node.collapsed && node.element.stale) {\r\n            if (deep) {\r\n                this.collapse(node.element.element);\r\n            }\r\n            else {\r\n                this.refreshAndRenderNode(node.element, false)\r\n                    .catch(onUnexpectedError);\r\n            }\r\n        }\r\n    };\r\n    AsyncDataTree.prototype.setChildren = function (node, childrenElements, recursive, viewStateContext) {\r\n        var _a;\r\n        var _this = this;\r\n        // perf: if the node was and still is a leaf, avoid all this hassle\r\n        if (node.children.length === 0 && childrenElements.length === 0) {\r\n            return [];\r\n        }\r\n        var nodesToForget = new Map();\r\n        var childrenTreeNodesById = new Map();\r\n        for (var _i = 0, _b = node.children; _i < _b.length; _i++) {\r\n            var child = _b[_i];\r\n            nodesToForget.set(child.element, child);\r\n            if (this.identityProvider) {\r\n                var collapsed = this.tree.isCollapsed(child);\r\n                childrenTreeNodesById.set(child.id, { node: child, collapsed: collapsed });\r\n            }\r\n        }\r\n        var childrenToRefresh = [];\r\n        var children = childrenElements.map(function (element) {\r\n            var hasChildren = !!_this.dataSource.hasChildren(element);\r\n            if (!_this.identityProvider) {\r\n                var asyncDataTreeNode = createAsyncDataTreeNode({ element: element, parent: node, hasChildren: hasChildren });\r\n                if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\r\n                    asyncDataTreeNode.collapsedByDefault = false;\r\n                    childrenToRefresh.push(asyncDataTreeNode);\r\n                }\r\n                return asyncDataTreeNode;\r\n            }\r\n            var id = _this.identityProvider.getId(element).toString();\r\n            var result = childrenTreeNodesById.get(id);\r\n            if (result) {\r\n                var asyncDataTreeNode = result.node;\r\n                nodesToForget.delete(asyncDataTreeNode.element);\r\n                _this.nodes.delete(asyncDataTreeNode.element);\r\n                _this.nodes.set(element, asyncDataTreeNode);\r\n                asyncDataTreeNode.element = element;\r\n                asyncDataTreeNode.hasChildren = hasChildren;\r\n                if (recursive) {\r\n                    if (result.collapsed) {\r\n                        asyncDataTreeNode.children.forEach(function (node) { return dfs(node, function (node) { return _this.nodes.delete(node.element); }); });\r\n                        asyncDataTreeNode.children.splice(0, asyncDataTreeNode.children.length);\r\n                        asyncDataTreeNode.stale = true;\r\n                    }\r\n                    else {\r\n                        childrenToRefresh.push(asyncDataTreeNode);\r\n                    }\r\n                }\r\n                else if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\r\n                    asyncDataTreeNode.collapsedByDefault = false;\r\n                    childrenToRefresh.push(asyncDataTreeNode);\r\n                }\r\n                return asyncDataTreeNode;\r\n            }\r\n            var childAsyncDataTreeNode = createAsyncDataTreeNode({ element: element, parent: node, id: id, hasChildren: hasChildren });\r\n            if (viewStateContext && viewStateContext.viewState.focus && viewStateContext.viewState.focus.indexOf(id) > -1) {\r\n                viewStateContext.focus.push(childAsyncDataTreeNode);\r\n            }\r\n            if (viewStateContext && viewStateContext.viewState.selection && viewStateContext.viewState.selection.indexOf(id) > -1) {\r\n                viewStateContext.selection.push(childAsyncDataTreeNode);\r\n            }\r\n            if (viewStateContext && viewStateContext.viewState.expanded && viewStateContext.viewState.expanded.indexOf(id) > -1) {\r\n                childrenToRefresh.push(childAsyncDataTreeNode);\r\n            }\r\n            else if (hasChildren && _this.collapseByDefault && !_this.collapseByDefault(element)) {\r\n                childAsyncDataTreeNode.collapsedByDefault = false;\r\n                childrenToRefresh.push(childAsyncDataTreeNode);\r\n            }\r\n            return childAsyncDataTreeNode;\r\n        });\r\n        for (var _c = 0, _d = values(nodesToForget); _c < _d.length; _c++) {\r\n            var node_1 = _d[_c];\r\n            dfs(node_1, function (node) { return _this.nodes.delete(node.element); });\r\n        }\r\n        for (var _e = 0, children_1 = children; _e < children_1.length; _e++) {\r\n            var child = children_1[_e];\r\n            this.nodes.set(child.element, child);\r\n        }\r\n        (_a = node.children).splice.apply(_a, __spreadArrays([0, node.children.length], children));\r\n        // TODO@joao this doesn't take filter into account\r\n        if (node !== this.root && this.autoExpandSingleChildren && children.length === 1 && childrenToRefresh.length === 0) {\r\n            children[0].collapsedByDefault = false;\r\n            childrenToRefresh.push(children[0]);\r\n        }\r\n        return childrenToRefresh;\r\n    };\r\n    AsyncDataTree.prototype.render = function (node, viewStateContext) {\r\n        var _this = this;\r\n        var children = node.children.map(function (node) { return _this.asTreeElement(node, viewStateContext); });\r\n        this.tree.setChildren(node === this.root ? null : node, children);\r\n        if (node !== this.root) {\r\n            this.tree.setCollapsible(node, node.hasChildren);\r\n        }\r\n        this._onDidRender.fire();\r\n    };\r\n    AsyncDataTree.prototype.asTreeElement = function (node, viewStateContext) {\r\n        var _this = this;\r\n        if (node.stale) {\r\n            return {\r\n                element: node,\r\n                collapsible: node.hasChildren,\r\n                collapsed: true\r\n            };\r\n        }\r\n        var collapsed;\r\n        if (viewStateContext && viewStateContext.viewState.expanded && node.id && viewStateContext.viewState.expanded.indexOf(node.id) > -1) {\r\n            collapsed = false;\r\n        }\r\n        else {\r\n            collapsed = node.collapsedByDefault;\r\n        }\r\n        node.collapsedByDefault = undefined;\r\n        return {\r\n            element: node,\r\n            children: node.hasChildren ? Iterator.map(Iterator.fromArray(node.children), function (child) { return _this.asTreeElement(child, viewStateContext); }) : [],\r\n            collapsible: node.hasChildren,\r\n            collapsed: collapsed\r\n        };\r\n    };\r\n    AsyncDataTree.prototype.processChildren = function (children) {\r\n        if (this.sorter) {\r\n            children.sort(this.sorter.compare.bind(this.sorter));\r\n        }\r\n        return children;\r\n    };\r\n    AsyncDataTree.prototype.dispose = function () {\r\n        this.disposables.dispose();\r\n    };\r\n    return AsyncDataTree;\r\n}());\r\nexport { AsyncDataTree };\r\nvar CompressibleAsyncDataTreeNodeWrapper = /** @class */ (function () {\r\n    function CompressibleAsyncDataTreeNodeWrapper(node) {\r\n        this.node = node;\r\n    }\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"element\", {\r\n        get: function () {\r\n            return {\r\n                elements: this.node.element.elements.map(function (e) { return e.element; }),\r\n                incompressible: this.node.element.incompressible\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"children\", {\r\n        get: function () { return this.node.children.map(function (node) { return new CompressibleAsyncDataTreeNodeWrapper(node); }); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"depth\", {\r\n        get: function () { return this.node.depth; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visibleChildrenCount\", {\r\n        get: function () { return this.node.visibleChildrenCount; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visibleChildIndex\", {\r\n        get: function () { return this.node.visibleChildIndex; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"collapsible\", {\r\n        get: function () { return this.node.collapsible; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"collapsed\", {\r\n        get: function () { return this.node.collapsed; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"visible\", {\r\n        get: function () { return this.node.visible; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CompressibleAsyncDataTreeNodeWrapper.prototype, \"filterData\", {\r\n        get: function () { return this.node.filterData; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return CompressibleAsyncDataTreeNodeWrapper;\r\n}());\r\nvar CompressibleAsyncDataTreeRenderer = /** @class */ (function () {\r\n    function CompressibleAsyncDataTreeRenderer(renderer, nodeMapper, compressibleNodeMapperProvider, onDidChangeTwistieState) {\r\n        this.renderer = renderer;\r\n        this.nodeMapper = nodeMapper;\r\n        this.compressibleNodeMapperProvider = compressibleNodeMapperProvider;\r\n        this.onDidChangeTwistieState = onDidChangeTwistieState;\r\n        this.renderedNodes = new Map();\r\n        this.disposables = [];\r\n        this.templateId = renderer.templateId;\r\n    }\r\n    CompressibleAsyncDataTreeRenderer.prototype.renderTemplate = function (container) {\r\n        var templateData = this.renderer.renderTemplate(container);\r\n        return { templateData: templateData };\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.renderElement = function (node, index, templateData, height) {\r\n        this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.renderCompressedElements = function (node, index, templateData, height) {\r\n        this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.renderTwistie = function (element, twistieElement) {\r\n        toggleClass(twistieElement, 'codicon-loading', element.slow);\r\n        return false;\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.disposeElement = function (node, index, templateData, height) {\r\n        if (this.renderer.disposeElement) {\r\n            this.renderer.disposeElement(this.nodeMapper.map(node), index, templateData.templateData, height);\r\n        }\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.disposeCompressedElements = function (node, index, templateData, height) {\r\n        if (this.renderer.disposeCompressedElements) {\r\n            this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\r\n        }\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.disposeTemplate = function (templateData) {\r\n        this.renderer.disposeTemplate(templateData.templateData);\r\n    };\r\n    CompressibleAsyncDataTreeRenderer.prototype.dispose = function () {\r\n        this.renderedNodes.clear();\r\n        this.disposables = dispose(this.disposables);\r\n    };\r\n    return CompressibleAsyncDataTreeRenderer;\r\n}());\r\nfunction asCompressibleObjectTreeOptions(options) {\r\n    var objectTreeOptions = options && asObjectTreeOptions(options);\r\n    return objectTreeOptions && __assign(__assign({}, objectTreeOptions), { keyboardNavigationLabelProvider: objectTreeOptions.keyboardNavigationLabelProvider && __assign(__assign({}, objectTreeOptions.keyboardNavigationLabelProvider), { getCompressedNodeKeyboardNavigationLabel: function (els) {\r\n                return options.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(els.map(function (e) { return e.element; }));\r\n            } }) });\r\n}\r\nvar CompressibleAsyncDataTree = /** @class */ (function (_super) {\r\n    __extends(CompressibleAsyncDataTree, _super);\r\n    function CompressibleAsyncDataTree(user, container, virtualDelegate, compressionDelegate, renderers, dataSource, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, user, container, virtualDelegate, renderers, dataSource, options) || this;\r\n        _this.compressionDelegate = compressionDelegate;\r\n        _this.compressibleNodeMapper = new WeakMapper(function (node) { return new CompressibleAsyncDataTreeNodeWrapper(node); });\r\n        _this.filter = options.filter;\r\n        return _this;\r\n    }\r\n    CompressibleAsyncDataTree.prototype.createTree = function (user, container, delegate, renderers, options) {\r\n        var _this = this;\r\n        var objectTreeDelegate = new ComposedTreeDelegate(delegate);\r\n        var objectTreeRenderers = renderers.map(function (r) { return new CompressibleAsyncDataTreeRenderer(r, _this.nodeMapper, function () { return _this.compressibleNodeMapper; }, _this._onDidChangeNodeSlowState.event); });\r\n        var objectTreeOptions = asCompressibleObjectTreeOptions(options) || {};\r\n        return new CompressibleObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\r\n    };\r\n    CompressibleAsyncDataTree.prototype.asTreeElement = function (node, viewStateContext) {\r\n        return __assign({ incompressible: this.compressionDelegate.isIncompressible(node.element) }, _super.prototype.asTreeElement.call(this, node, viewStateContext));\r\n    };\r\n    CompressibleAsyncDataTree.prototype.updateOptions = function (options) {\r\n        if (options === void 0) { options = {}; }\r\n        this.tree.updateOptions(options);\r\n    };\r\n    CompressibleAsyncDataTree.prototype.render = function (node, viewStateContext) {\r\n        var _this = this;\r\n        if (!this.identityProvider) {\r\n            return _super.prototype.render.call(this, node, viewStateContext);\r\n        }\r\n        // Preserve traits across compressions. Hacky but does the trick.\r\n        // This is hard to fix properly since it requires rewriting the traits\r\n        // across trees and lists. Let's just keep it this way for now.\r\n        var getId = function (element) { return _this.identityProvider.getId(element).toString(); };\r\n        var getUncompressedIds = function (nodes) {\r\n            var result = new Set();\r\n            for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\r\n                var node_2 = nodes_1[_i];\r\n                var compressedNode = _this.tree.getCompressedTreeNode(node_2 === _this.root ? null : node_2);\r\n                if (!compressedNode.element) {\r\n                    continue;\r\n                }\r\n                for (var _a = 0, _b = compressedNode.element.elements; _a < _b.length; _a++) {\r\n                    var node_3 = _b[_a];\r\n                    result.add(getId(node_3.element));\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n        var oldSelection = getUncompressedIds(this.tree.getSelection());\r\n        var oldFocus = getUncompressedIds(this.tree.getFocus());\r\n        _super.prototype.render.call(this, node, viewStateContext);\r\n        var selection = this.getSelection();\r\n        var didChangeSelection = false;\r\n        var focus = this.getFocus();\r\n        var didChangeFocus = false;\r\n        var visit = function (node) {\r\n            var compressedNode = node.element;\r\n            if (compressedNode) {\r\n                for (var i = 0; i < compressedNode.elements.length; i++) {\r\n                    var id = getId(compressedNode.elements[i].element);\r\n                    var element = compressedNode.elements[compressedNode.elements.length - 1].element;\r\n                    // github.com/microsoft/vscode/issues/85938\r\n                    if (oldSelection.has(id) && selection.indexOf(element) === -1) {\r\n                        selection.push(element);\r\n                        didChangeSelection = true;\r\n                    }\r\n                    if (oldFocus.has(id) && focus.indexOf(element) === -1) {\r\n                        focus.push(element);\r\n                        didChangeFocus = true;\r\n                    }\r\n                }\r\n            }\r\n            node.children.forEach(visit);\r\n        };\r\n        visit(this.tree.getCompressedTreeNode(node === this.root ? null : node));\r\n        if (didChangeSelection) {\r\n            this.setSelection(selection);\r\n        }\r\n        if (didChangeFocus) {\r\n            this.setFocus(focus);\r\n        }\r\n    };\r\n    // For compressed async data trees, `TreeVisibility.Recurse` doesn't currently work\r\n    // and we have to filter everything beforehand\r\n    // Related to #85193 and #85835\r\n    CompressibleAsyncDataTree.prototype.processChildren = function (children) {\r\n        var _this = this;\r\n        if (this.filter) {\r\n            children = children.filter(function (e) {\r\n                var result = _this.filter.filter(e, 1 /* Visible */);\r\n                var visibility = getVisibility(result);\r\n                if (visibility === 2 /* Recurse */) {\r\n                    throw new Error('Recursive tree visibility not supported in async data compressed trees');\r\n                }\r\n                return visibility === 1 /* Visible */;\r\n            });\r\n        }\r\n        return _super.prototype.processChildren.call(this, children);\r\n    };\r\n    return CompressibleAsyncDataTree;\r\n}(AsyncDataTree));\r\nexport { CompressibleAsyncDataTree };\r\nfunction getVisibility(filterResult) {\r\n    if (typeof filterResult === 'boolean') {\r\n        return filterResult ? 1 /* Visible */ : 0 /* Hidden */;\r\n    }\r\n    else if (isFilterResult(filterResult)) {\r\n        return getVisibleState(filterResult.visibility);\r\n    }\r\n    else {\r\n        return getVisibleState(filterResult);\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}