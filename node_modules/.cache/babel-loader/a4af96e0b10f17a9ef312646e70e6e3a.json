{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { CodeLensModel } from './codelens.js';\nimport { LRUCache, values } from '../../../base/common/map.js';\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\nimport { Range } from '../../common/core/range.js';\nimport { runWhenIdle } from '../../../base/common/async.js';\nimport { once } from '../../../base/common/functional.js';\nexport var ICodeLensCache = createDecorator('ICodeLensCache');\nvar CacheItem = /** @class */function () {\n  function CacheItem(lineCount, data) {\n    this.lineCount = lineCount;\n    this.data = data;\n  }\n  return CacheItem;\n}();\nvar CodeLensCache = /** @class */function () {\n  function CodeLensCache(storageService) {\n    var _this = this;\n    this._fakeProvider = new ( /** @class */function () {\n      function class_1() {}\n      class_1.prototype.provideCodeLenses = function () {\n        throw new Error('not supported');\n      };\n      return class_1;\n    }())();\n    this._cache = new LRUCache(20, 0.75);\n    // remove old data\n    var oldkey = 'codelens/cache';\n    runWhenIdle(function () {\n      return storageService.remove(oldkey, 1 /* WORKSPACE */);\n    });\n    // restore lens data on start\n    var key = 'codelens/cache2';\n    var raw = storageService.get(key, 1 /* WORKSPACE */, '{}');\n    this._deserialize(raw);\n    // store lens data on shutdown\n    once(storageService.onWillSaveState)(function (e) {\n      if (e.reason === WillSaveStateReason.SHUTDOWN) {\n        storageService.store(key, _this._serialize(), 1 /* WORKSPACE */);\n      }\n    });\n  }\n\n  CodeLensCache.prototype.put = function (model, data) {\n    // create a copy of the model that is without command-ids\n    // but with comand-labels\n    var copyItems = data.lenses.map(function (item) {\n      var _a;\n      return {\n        range: item.symbol.range,\n        command: item.symbol.command && {\n          id: '',\n          title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title\n        }\n      };\n    });\n    var copyModel = new CodeLensModel();\n    copyModel.add({\n      lenses: copyItems,\n      dispose: function dispose() {}\n    }, this._fakeProvider);\n    var item = new CacheItem(model.getLineCount(), copyModel);\n    this._cache.set(model.uri.toString(), item);\n  };\n  CodeLensCache.prototype.get = function (model) {\n    var item = this._cache.get(model.uri.toString());\n    return item && item.lineCount === model.getLineCount() ? item.data : undefined;\n  };\n  CodeLensCache.prototype.delete = function (model) {\n    this._cache.delete(model.uri.toString());\n  };\n  // --- persistence\n  CodeLensCache.prototype._serialize = function () {\n    var data = Object.create(null);\n    this._cache.forEach(function (value, key) {\n      var lines = new Set();\n      for (var _i = 0, _a = value.data.lenses; _i < _a.length; _i++) {\n        var d = _a[_i];\n        lines.add(d.symbol.range.startLineNumber);\n      }\n      data[key] = {\n        lineCount: value.lineCount,\n        lines: values(lines)\n      };\n    });\n    return JSON.stringify(data);\n  };\n  CodeLensCache.prototype._deserialize = function (raw) {\n    try {\n      var data = JSON.parse(raw);\n      for (var key in data) {\n        var element = data[key];\n        var lenses = [];\n        for (var _i = 0, _a = element.lines; _i < _a.length; _i++) {\n          var line = _a[_i];\n          lenses.push({\n            range: new Range(line, 1, line, 11)\n          });\n        }\n        var model = new CodeLensModel();\n        model.add({\n          lenses: lenses,\n          dispose: function dispose() {}\n        }, this._fakeProvider);\n        this._cache.set(key, new CacheItem(element.lineCount, model));\n      }\n    } catch (_b) {\n      // ignore...\n    }\n  };\n  CodeLensCache = __decorate([__param(0, IStorageService)], CodeLensCache);\n  return CodeLensCache;\n}();\nexport { CodeLensCache };\nregisterSingleton(ICodeLensCache, CodeLensCache);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","createDecorator","registerSingleton","CodeLensModel","LRUCache","values","IStorageService","WillSaveStateReason","Range","runWhenIdle","once","ICodeLensCache","CacheItem","lineCount","data","CodeLensCache","storageService","_this","_fakeProvider","class_1","prototype","provideCodeLenses","Error","_cache","oldkey","remove","raw","get","_deserialize","onWillSaveState","e","reason","SHUTDOWN","store","_serialize","put","model","copyItems","lenses","map","item","_a","range","symbol","command","id","title","copyModel","add","dispose","getLineCount","set","uri","toString","undefined","delete","create","forEach","value","lines","Set","_i","startLineNumber","JSON","stringify","parse","element","line","push","_b"],"sources":["C:/Users/akash/Desktop/agat project/CLientapp/node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codeLensCache.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { CodeLensModel } from './codelens.js';\r\nimport { LRUCache, values } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { runWhenIdle } from '../../../base/common/async.js';\r\nimport { once } from '../../../base/common/functional.js';\r\nexport var ICodeLensCache = createDecorator('ICodeLensCache');\r\nvar CacheItem = /** @class */ (function () {\r\n    function CacheItem(lineCount, data) {\r\n        this.lineCount = lineCount;\r\n        this.data = data;\r\n    }\r\n    return CacheItem;\r\n}());\r\nvar CodeLensCache = /** @class */ (function () {\r\n    function CodeLensCache(storageService) {\r\n        var _this = this;\r\n        this._fakeProvider = new /** @class */ (function () {\r\n            function class_1() {\r\n            }\r\n            class_1.prototype.provideCodeLenses = function () {\r\n                throw new Error('not supported');\r\n            };\r\n            return class_1;\r\n        }());\r\n        this._cache = new LRUCache(20, 0.75);\r\n        // remove old data\r\n        var oldkey = 'codelens/cache';\r\n        runWhenIdle(function () { return storageService.remove(oldkey, 1 /* WORKSPACE */); });\r\n        // restore lens data on start\r\n        var key = 'codelens/cache2';\r\n        var raw = storageService.get(key, 1 /* WORKSPACE */, '{}');\r\n        this._deserialize(raw);\r\n        // store lens data on shutdown\r\n        once(storageService.onWillSaveState)(function (e) {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                storageService.store(key, _this._serialize(), 1 /* WORKSPACE */);\r\n            }\r\n        });\r\n    }\r\n    CodeLensCache.prototype.put = function (model, data) {\r\n        // create a copy of the model that is without command-ids\r\n        // but with comand-labels\r\n        var copyItems = data.lenses.map(function (item) {\r\n            var _a;\r\n            return {\r\n                range: item.symbol.range,\r\n                command: item.symbol.command && { id: '', title: (_a = item.symbol.command) === null || _a === void 0 ? void 0 : _a.title },\r\n            };\r\n        });\r\n        var copyModel = new CodeLensModel();\r\n        copyModel.add({ lenses: copyItems, dispose: function () { } }, this._fakeProvider);\r\n        var item = new CacheItem(model.getLineCount(), copyModel);\r\n        this._cache.set(model.uri.toString(), item);\r\n    };\r\n    CodeLensCache.prototype.get = function (model) {\r\n        var item = this._cache.get(model.uri.toString());\r\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\r\n    };\r\n    CodeLensCache.prototype.delete = function (model) {\r\n        this._cache.delete(model.uri.toString());\r\n    };\r\n    // --- persistence\r\n    CodeLensCache.prototype._serialize = function () {\r\n        var data = Object.create(null);\r\n        this._cache.forEach(function (value, key) {\r\n            var lines = new Set();\r\n            for (var _i = 0, _a = value.data.lenses; _i < _a.length; _i++) {\r\n                var d = _a[_i];\r\n                lines.add(d.symbol.range.startLineNumber);\r\n            }\r\n            data[key] = {\r\n                lineCount: value.lineCount,\r\n                lines: values(lines)\r\n            };\r\n        });\r\n        return JSON.stringify(data);\r\n    };\r\n    CodeLensCache.prototype._deserialize = function (raw) {\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            for (var key in data) {\r\n                var element = data[key];\r\n                var lenses = [];\r\n                for (var _i = 0, _a = element.lines; _i < _a.length; _i++) {\r\n                    var line = _a[_i];\r\n                    lenses.push({ range: new Range(line, 1, line, 11) });\r\n                }\r\n                var model = new CodeLensModel();\r\n                model.add({ lenses: lenses, dispose: function () { } }, this._fakeProvider);\r\n                this._cache.set(key, new CacheItem(element.lineCount, model));\r\n            }\r\n        }\r\n        catch (_b) {\r\n            // ignore...\r\n        }\r\n    };\r\n    CodeLensCache = __decorate([\r\n        __param(0, IStorageService)\r\n    ], CodeLensCache);\r\n    return CodeLensCache;\r\n}());\r\nexport { CodeLensCache };\r\nregisterSingleton(ICodeLensCache, CodeLensCache);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}